{"version":3,"sources":["../../src/utils/observer/index.ts","../../src/utils/debounce.ts","../../src/domain/html/index.ts","../../src/services/gitlab/selectors.ts","../../src/services/gitlab/index.ts","../../src/utils/html/index.ts","../../src/features/pn-rule/replacer.ts","../../src/features/pn-rule/observer.ts","../../src/features/pn-rule/index.ts","../../src/features/rm-mr-filter/utils.ts","../../src/features/rm-mr-filter/ui/RemoveButton.ts","../../src/features/rm-mr-filter/index.ts","../../src/domain/clickup/index.ts","../../src/features/clickup-content/ui/Modal.ts","../../src/features/clickup-content/ui/SidePanel.ts","../../src/features/clickup-content/detector.ts","../../src/features/clickup-content/observer.ts","../../src/features/clickup-content/index.ts","../../src/features/inject/index.ts"],"sourcesContent":["/**\n * MutationObserver management utilities\n */\n\ntype ObserverEntry = {\n  observer: MutationObserver;\n  target: Node;\n};\n\nconst observers: Map<string, ObserverEntry> = new Map();\n\nexport interface ObserverOptions {\n  id: string;\n  target: Node;\n  callback: MutationCallback;\n  config?: MutationObserverInit;\n}\n\nconst defaultConfig: MutationObserverInit = {\n  childList: true,\n  subtree: true,\n};\n\n/**\n * Creates and registers a MutationObserver\n */\nexport function createObserver(options: ObserverOptions): MutationObserver {\n  const { id, target, callback, config = defaultConfig } = options;\n\n  // Disconnect existing observer with same id\n  if (observers.has(id)) {\n    disconnectObserver(id);\n  }\n\n  const observer = new MutationObserver(callback);\n  observer.observe(target, config);\n\n  observers.set(id, { observer, target });\n\n  return observer;\n}\n\n/**\n * Disconnects a specific observer by id\n */\nexport function disconnectObserver(id: string): boolean {\n  const entry = observers.get(id);\n  if (entry) {\n    entry.observer.disconnect();\n    observers.delete(id);\n    return true;\n  }\n  return false;\n}\n\n/**\n * Disconnects all registered observers\n */\nexport function disconnectAllObservers(): void {\n  observers.forEach((entry) => {\n    entry.observer.disconnect();\n  });\n  observers.clear();\n}\n\n/**\n * Gets the count of active observers\n */\nexport function getObserverCount(): number {\n  return observers.size;\n}\n","export function debounce(func: Function, wait: number) {\n  let timeout: ReturnType<typeof setTimeout> | undefined;\n  return function (this: any, ...args: any[]) {\n    const later = () => {\n      timeout = undefined;\n      func.apply(this, args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n}\n","export function genMarker({\n  name,\n  replacement,\n  bgColor,\n  textColor,\n}:{\n  name: string;\n  replacement: string;\n  bgColor?: string;\n  textColor?: string;\n}) {\n  return `<mark name=\"${name}\" style=\"background-color: ${bgColor}; color: ${textColor}\">${replacement}</mark>`;\n}\n","/**\n * GitLab DOM Selectors\n * Centralized selectors for GitLab-specific elements\n */\n\nexport const SELECTORS = {\n  // Note elements in MR discussion\n  notes: \"div.note-body > div.note-text.md [data-sourcepos][dir='auto']\",\n\n  // Filter dropdown elements\n  filterDropdown: 'div.filtered-search-history-dropdown',\n  filterDropdownButton: 'button.filtered-search-history-dropdown-toggle-button',\n  filterListItem: 'li[data-testid=\"dropdown-item\"]:not(.gl-text-subtle)',\n\n  // Custom remove button class\n  customRemoveButton: '.custom-rm-btn',\n} as const;\n\nexport type SelectorKey = keyof typeof SELECTORS;\n","import { SELECTORS } from './selectors';\n\nexport function getNotes() {\n  return document.querySelectorAll(SELECTORS.notes);\n}\n\nexport function getFilterDropdown() {\n  return document.querySelector(SELECTORS.filterDropdown);\n}\n\nexport function getFilterDropdownButton() {\n  return document.querySelector(SELECTORS.filterDropdownButton);\n}\n\nexport function getFilterListItems() {\n  const dropdown = getFilterDropdown();\n  if (!dropdown) return null;\n  return dropdown.querySelectorAll(SELECTORS.filterListItem);\n}\n\nexport { SELECTORS };\n","export function escapeHtml(unsafe: string) {\n  return unsafe\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#039;\");\n};\n","import { genMarker } from \"@domain/html\";\nimport {\n  findPn,\n  getBgColorKey,\n  getReplacementKey,\n  getTextColorKey,\n  isPnRule,\n  PnRuleMapWithColor,\n  PnRuleSub,\n} from \"@domain/pn\";\nimport { getNotes } from \"@services/gitlab\";\nimport { escapeHtml } from \"@utils/html\";\n\n/**\n * Updates existing mark elements with new replacement values\n */\nexport function replaceText(replacementMap: Record<string, string>): void {\n  const marks = document.querySelectorAll(\"mark[name]\");\n\n  marks.forEach((mark) => {\n    if (!(mark instanceof HTMLElement)) return;\n\n    const rule = mark.getAttribute(\"name\")?.toLocaleLowerCase();\n    if (!isPnRule(rule)) return;\n\n    for (const key of Object.keys(replacementMap)) {\n      if (key.startsWith(rule)) {\n        const replacementKey = getReplacementKey(rule);\n        const bgColorKey = getBgColorKey(rule);\n        const textColorKey = getTextColorKey(rule);\n\n        if (replacementMap[replacementKey]) {\n          mark.textContent = escapeHtml(replacementMap[replacementKey]);\n        }\n        if (replacementMap[bgColorKey]) {\n          mark.style.backgroundColor = replacementMap[bgColorKey];\n        }\n        if (replacementMap[textColorKey]) {\n          mark.style.color = replacementMap[textColorKey];\n        }\n      }\n    }\n  });\n}\n\n/**\n * Replaces Pn prefixes in notes with styled markers\n */\nexport function replacePnText(replacementMap: PnRuleMapWithColor): void {\n  const notes = getNotes();\n\n  notes.forEach((note) => {\n    const pn = findPn(note.innerHTML);\n\n    if (pn && pn.toLowerCase() in replacementMap) {\n      const replacementKey = getReplacementKey(pn as PnRuleSub);\n      const bgColorKey = getBgColorKey(pn as PnRuleSub);\n      const textColorKey = getTextColorKey(pn as PnRuleSub);\n\n      note.innerHTML = note.innerHTML.replace(\n        pn,\n        genMarker({\n          name: pn,\n          bgColor: replacementMap[bgColorKey],\n          textColor: replacementMap[textColorKey],\n          replacement: escapeHtml(replacementMap[replacementKey]),\n        })\n      );\n    }\n  });\n}\n","import { isPnRuleMap, PnRuleMapWithColor } from \"@domain/pn\";\nimport { createObserver, disconnectObserver } from \"@utils/observer\";\nimport { debounce } from \"@utils/debounce\";\nimport { replacePnText } from \"./replacer\";\n\nconst OBSERVER_ID = \"pn-rule-observer\";\n\n/**\n * Creates a MutationObserver that watches for DOM changes\n * and applies Pn text replacements\n */\nexport function createPnRuleObserver(pnMap: PnRuleMapWithColor): void {\n  const debouncedCallback = debounce((mutations: MutationRecord[]) => {\n    mutations.forEach((mutation) => {\n      if (mutation.type === \"childList\" && isPnRuleMap(pnMap)) {\n        replacePnText(pnMap);\n      }\n    });\n  }, 20);\n\n  createObserver({\n    id: OBSERVER_ID,\n    target: document.body,\n    callback: debouncedCallback,\n    config: { childList: true, subtree: true },\n  });\n}\n\n/**\n * Disconnects the Pn rule observer\n */\nexport function disconnectPnRuleObserver(): void {\n  disconnectObserver(OBSERVER_ID);\n}\n","import { isPnRuleMap, PnRuleMapWithColor } from \"@domain/pn\";\nimport { getAllFromChromeLocalStorage, subscribeToChromeStorage } from \"@utils/chrome\";\nimport { createPnRuleObserver, disconnectPnRuleObserver } from \"./observer\";\nimport { replaceText } from \"./replacer\";\n\nlet unsubscribeStorage: (() => void) | null = null;\n\n/**\n * Initializes the Pn rule feature\n */\nexport async function initPnRule(): Promise<void> {\n  const pnMap = await getAllFromChromeLocalStorage() as PnRuleMapWithColor;\n\n  unsubscribeStorage = subscribeToChromeStorage((changes) => {\n    const tmpMap: Record<string, string> = {};\n    Object.entries(changes).forEach(([key, change]) => {\n      (pnMap as Record<string, unknown>)[key] = change.newValue;\n      tmpMap[key] = change.newValue;\n    });\n    replaceText(tmpMap);\n  });\n\n  if (isPnRuleMap(pnMap)) {\n    createPnRuleObserver(pnMap);\n  }\n}\n\n/**\n * Cleans up the Pn rule feature\n */\nexport function cleanupPnRule(): void {\n  if (unsubscribeStorage) {\n    unsubscribeStorage();\n    unsubscribeStorage = null;\n  }\n  disconnectPnRuleObserver();\n}\n","// interface Filter {\n//   type: string;\n//   value: {\n//     data: string;\n//     operator: string;\n//   };\n//   id: string;\n// }\n\n// type FilterList = Filter[][];\n\ntype FilterList = string[];\n\nexport function getKey() {\n  const url = new URL(window.location.href);\n  const pathname = url.pathname;\n  const [project] = pathname.split(\"/-/\");\n  return `${project.slice(1)}-merge-request-recent-searches`;\n}\n\nexport function getFilterList() {\n  const key = getKey();\n  const value = localStorage.getItem(key);\n  if (!value) return [];\n  return JSON.parse(value) as FilterList;\n}\n\nexport function setFilterList(filterList: FilterList) {\n  const key = getKey();\n  localStorage.setItem(key, JSON.stringify(filterList));\n}\n\nexport function removeFilterByIndex(e: MouseEvent) {\n  const filterList = getFilterList();\n  const li = (e.target as HTMLButtonElement).parentElement?.parentElement;\n  const siblings = Array.from(li?.parentElement?.children ?? []);\n\n  if (!li || siblings.length === 0) {\n    console.warn(`cannot find li or siblings`);\n    return;\n  }\n  const idx = siblings.indexOf(li as Element);\n  if (idx === -1) {\n    console.warn(`cannot find index of ${li} from ${siblings}`);\n    return;\n  }\n  console.log(`remove filter at index ${idx}`, filterList);\n  filterList.splice(idx, 1);\n  setFilterList(filterList);\n}\n","export function RemoveButton() {\n  const removeButton = document.createElement('button');\n  removeButton.type = 'button';\n\n  removeButton.classList.add('custom-rm-btn');\n  removeButton.innerHTML = `\n<svg class=\"s16 close-icon\"><use xlink:href=\"/assets/icons-0b41337f52be73f7bbf9d59b841eb98a6e790dfa1a844644f120a80ce3cc18ba.svg#close\"></use></svg>\n  `;\n  return removeButton;\n}\n","import { getFilterDropdownButton, getFilterListItems, SELECTORS } from \"@services/gitlab\";\nimport { createObserver, disconnectObserver } from \"@utils/observer\";\nimport { removeFilterByIndex } from \"./utils\";\nimport { RemoveButton } from \"./ui/RemoveButton\";\n\nconst OBSERVER_ID = \"rm-mr-filter-observer\";\n\nfunction addRemoveButtonsToFilters(): void {\n  const filterList = getFilterListItems();\n\n  filterList?.forEach((filter) => {\n    if (filter.querySelector(SELECTORS.customRemoveButton)) {\n      return;\n    }\n    const removeButton = RemoveButton();\n\n    filter.appendChild(removeButton);\n\n    removeButton.addEventListener('click', (e) => {\n      e.stopPropagation();\n      e.preventDefault();\n      removeFilterByIndex(e);\n      filter.remove();\n    });\n  });\n}\n\n/**\n * Initializes the filter removal feature\n */\nexport function initRmMrFilter(): void {\n  const button = getFilterDropdownButton();\n  if (!button) return;\n\n  createObserver({\n    id: OBSERVER_ID,\n    target: button,\n    callback: addRemoveButtonsToFilters,\n    config: { childList: true, subtree: true },\n  });\n\n  addRemoveButtonsToFilters();\n}\n\n/**\n * Cleans up the filter removal feature\n */\nexport function cleanupRmMrFilter(): void {\n  disconnectObserver(OBSERVER_ID);\n}\n","/**\n * ClickUp task ID pattern: {{clickup:TASK_ID}}\n */\nconst CLICKUP_PATTERN = /\\{\\{clickup:([a-zA-Z0-9]+)\\}\\}/g;\n\n/**\n * ClickUp base URL for tasks\n */\nconst CLICKUP_BASE_URL = \"https://app.clickup.com/t\";\n\n/**\n * Extracts all ClickUp task IDs from text\n * @param text - Text to search for ClickUp patterns\n * @returns Array of task IDs found\n */\nexport function findClickUpTaskIds(text: string): string[] {\n  const matches: string[] = [];\n  let match: RegExpExecArray | null;\n\n  // Reset regex lastIndex for fresh search\n  CLICKUP_PATTERN.lastIndex = 0;\n\n  while ((match = CLICKUP_PATTERN.exec(text)) !== null) {\n    matches.push(match[1]);\n  }\n\n  return matches;\n}\n\n/**\n * Generates ClickUp task URL from task ID\n * @param taskId - ClickUp task ID\n * @returns Full ClickUp task URL\n */\nexport function getClickUpTaskUrl(taskId: string): string {\n  return `${CLICKUP_BASE_URL}/${taskId}`;\n}\n\n/**\n * Creates a regex pattern for matching ClickUp patterns\n * @returns RegExp for matching {{clickup:ID}} patterns\n */\nexport function getClickUpPattern(): RegExp {\n  return new RegExp(CLICKUP_PATTERN.source, \"g\");\n}\n","import { getClickUpTaskUrl } from \"@domain/clickup\";\nimport type { IframeContainer } from \"./types\";\n\nconst MODAL_OVERLAY_CLASS = \"clickup-modal-overlay\";\nconst MODAL_CLASS = \"clickup-modal\";\nconst MODAL_HEADER_CLASS = \"clickup-modal-header\";\nconst MODAL_IFRAME_CLASS = \"clickup-modal-iframe\";\nconst MODAL_LOADING_CLASS = \"clickup-modal-loading\";\n\n/**\n * Modal component for displaying ClickUp tasks in an iframe\n */\nexport class Modal implements IframeContainer {\n  private overlay: HTMLDivElement | null = null;\n  private currentTaskId: string | null = null;\n  private onPinToSidePanel: ((taskId: string) => void) | null = null;\n\n  constructor(onPinToSidePanel?: (taskId: string) => void) {\n    this.onPinToSidePanel = onPinToSidePanel || null;\n  }\n\n  getIframeSrc(taskId: string): string {\n    return getClickUpTaskUrl(taskId);\n  }\n\n  isVisible(): boolean {\n    return this.overlay !== null && this.overlay.style.display !== \"none\";\n  }\n\n  getCurrentTaskId(): string | null {\n    return this.currentTaskId;\n  }\n\n  show(taskId: string): void {\n    this.currentTaskId = taskId;\n\n    // Create overlay if not exists\n    if (!this.overlay) {\n      this.createModal();\n    }\n\n    // Update iframe src\n    const iframe = this.overlay?.querySelector<HTMLIFrameElement>(\n      `.${MODAL_IFRAME_CLASS}`\n    );\n    const loading = this.overlay?.querySelector<HTMLDivElement>(\n      `.${MODAL_LOADING_CLASS}`\n    );\n\n    if (iframe) {\n      // Show loading state\n      if (loading) {\n        loading.style.display = \"flex\";\n      }\n      iframe.style.display = \"none\";\n\n      iframe.src = this.getIframeSrc(taskId);\n      iframe.onload = () => {\n        if (loading) {\n          loading.style.display = \"none\";\n        }\n        iframe.style.display = \"block\";\n      };\n      iframe.onerror = () => {\n        if (loading) {\n          loading.textContent = \"ë¡œë“œ ì‹¤íŒ¨\";\n        }\n      };\n    }\n\n    // Show overlay\n    if (this.overlay) {\n      this.overlay.style.display = \"flex\";\n    }\n\n    // Prevent body scroll\n    document.body.style.overflow = \"hidden\";\n  }\n\n  hide(): void {\n    if (this.overlay) {\n      this.overlay.style.display = \"none\";\n\n      // Clear iframe to stop loading\n      const iframe = this.overlay.querySelector<HTMLIFrameElement>(\n        `.${MODAL_IFRAME_CLASS}`\n      );\n      if (iframe) {\n        iframe.src = \"about:blank\";\n      }\n    }\n\n    this.currentTaskId = null;\n\n    // Restore body scroll\n    document.body.style.overflow = \"\";\n  }\n\n  destroy(): void {\n    this.hide();\n    if (this.overlay) {\n      this.overlay.remove();\n      this.overlay = null;\n    }\n  }\n\n  private createModal(): void {\n    // Create overlay\n    this.overlay = document.createElement(\"div\");\n    this.overlay.className = MODAL_OVERLAY_CLASS;\n\n    // Create modal container\n    const modal = document.createElement(\"div\");\n    modal.className = MODAL_CLASS;\n\n    // Create header\n    const header = document.createElement(\"div\");\n    header.className = MODAL_HEADER_CLASS;\n\n    // Close button\n    const closeBtn = document.createElement(\"button\");\n    closeBtn.className = \"clickup-modal-close\";\n    closeBtn.innerHTML = \"âœ•\";\n    closeBtn.title = \"ë‹«ê¸°\";\n    closeBtn.onclick = () => this.hide();\n\n    // Title\n    const title = document.createElement(\"span\");\n    title.className = \"clickup-modal-title\";\n    title.textContent = \"ClickUp\";\n\n    // Actions container\n    const actions = document.createElement(\"div\");\n    actions.className = \"clickup-modal-actions\";\n\n    // Open in new tab button\n    const newTabBtn = document.createElement(\"button\");\n    newTabBtn.className = \"clickup-modal-btn\";\n    newTabBtn.innerHTML = \"ðŸ”— ìƒˆ íƒ­ì—ì„œ ì—´ê¸°\";\n    newTabBtn.onclick = () => {\n      if (this.currentTaskId) {\n        window.open(this.getIframeSrc(this.currentTaskId), \"_blank\");\n      }\n    };\n\n    // Pin to side panel button\n    const pinBtn = document.createElement(\"button\");\n    pinBtn.className = \"clickup-modal-btn clickup-modal-btn-primary\";\n    pinBtn.innerHTML = \"ðŸ“Œ ì‚¬ì´ë“œë°”ë¡œ ê³ ì •\";\n    pinBtn.onclick = () => {\n      if (this.currentTaskId && this.onPinToSidePanel) {\n        this.onPinToSidePanel(this.currentTaskId);\n      }\n    };\n\n    actions.appendChild(newTabBtn);\n    actions.appendChild(pinBtn);\n\n    header.appendChild(closeBtn);\n    header.appendChild(title);\n    header.appendChild(actions);\n\n    // Create loading indicator\n    const loading = document.createElement(\"div\");\n    loading.className = MODAL_LOADING_CLASS;\n    loading.textContent = \"ë¡œë”© ì¤‘...\";\n\n    // Create iframe\n    const iframe = document.createElement(\"iframe\");\n    iframe.className = MODAL_IFRAME_CLASS;\n    iframe.setAttribute(\"allow\", \"clipboard-read; clipboard-write\");\n    iframe.style.display = \"none\";\n\n    // Assemble modal\n    modal.appendChild(header);\n    modal.appendChild(loading);\n    modal.appendChild(iframe);\n\n    this.overlay.appendChild(modal);\n\n    // Close on overlay click\n    this.overlay.onclick = (e) => {\n      if (e.target === this.overlay) {\n        this.hide();\n      }\n    };\n\n    // Close on Escape key\n    document.addEventListener(\"keydown\", (e) => {\n      if (e.key === \"Escape\" && this.isVisible()) {\n        this.hide();\n      }\n    });\n\n    document.body.appendChild(this.overlay);\n  }\n}\n\n/**\n * Singleton instance for easy access\n */\nlet modalInstance: Modal | null = null;\n\nexport function getModal(onPinToSidePanel?: (taskId: string) => void): Modal {\n  if (!modalInstance) {\n    modalInstance = new Modal(onPinToSidePanel);\n  }\n  return modalInstance;\n}\n\nexport function showModal(taskId: string): void {\n  getModal().show(taskId);\n}\n\nexport function hideModal(): void {\n  getModal().hide();\n}\n\nexport function destroyModal(): void {\n  if (modalInstance) {\n    modalInstance.destroy();\n    modalInstance = null;\n  }\n}\n","import { getClickUpTaskUrl } from \"@domain/clickup\";\nimport type { IframeContainer } from \"./types\";\n\nconst SIDE_PANEL_CLASS = \"clickup-side-panel\";\nconst SIDE_PANEL_HEADER_CLASS = \"clickup-side-panel-header\";\nconst SIDE_PANEL_IFRAME_CLASS = \"clickup-side-panel-iframe\";\nconst SIDE_PANEL_LOADING_CLASS = \"clickup-side-panel-loading\";\n\n/**\n * Side panel component for displaying ClickUp tasks alongside MR content\n */\nexport class SidePanel implements IframeContainer {\n  private panel: HTMLDivElement | null = null;\n  private currentTaskId: string | null = null;\n\n  getIframeSrc(taskId: string): string {\n    return getClickUpTaskUrl(taskId);\n  }\n\n  isVisible(): boolean {\n    return this.panel !== null && this.panel.classList.contains(\"visible\");\n  }\n\n  getCurrentTaskId(): string | null {\n    return this.currentTaskId;\n  }\n\n  show(taskId: string): void {\n    this.currentTaskId = taskId;\n\n    // Create panel if not exists\n    if (!this.panel) {\n      this.createPanel();\n    }\n\n    // Update iframe src\n    const iframe = this.panel?.querySelector<HTMLIFrameElement>(\n      `.${SIDE_PANEL_IFRAME_CLASS}`\n    );\n    const loading = this.panel?.querySelector<HTMLDivElement>(\n      `.${SIDE_PANEL_LOADING_CLASS}`\n    );\n\n    if (iframe) {\n      // Show loading state\n      if (loading) {\n        loading.style.display = \"flex\";\n      }\n      iframe.style.display = \"none\";\n\n      iframe.src = this.getIframeSrc(taskId);\n      iframe.onload = () => {\n        if (loading) {\n          loading.style.display = \"none\";\n        }\n        iframe.style.display = \"block\";\n      };\n      iframe.onerror = () => {\n        if (loading) {\n          loading.textContent = \"ë¡œë“œ ì‹¤íŒ¨\";\n        }\n      };\n    }\n\n    // Show panel\n    if (this.panel) {\n      this.panel.classList.add(\"visible\");\n    }\n\n    // Adjust main content width\n    this.adjustMainContent(true);\n  }\n\n  hide(): void {\n    if (this.panel) {\n      this.panel.classList.remove(\"visible\");\n\n      // Clear iframe to stop loading\n      const iframe = this.panel.querySelector<HTMLIFrameElement>(\n        `.${SIDE_PANEL_IFRAME_CLASS}`\n      );\n      if (iframe) {\n        iframe.src = \"about:blank\";\n      }\n    }\n\n    this.currentTaskId = null;\n\n    // Restore main content width\n    this.adjustMainContent(false);\n  }\n\n  destroy(): void {\n    this.hide();\n    if (this.panel) {\n      this.panel.remove();\n      this.panel = null;\n    }\n  }\n\n  private createPanel(): void {\n    this.panel = document.createElement(\"div\");\n    this.panel.className = SIDE_PANEL_CLASS;\n\n    // Create header\n    const header = document.createElement(\"div\");\n    header.className = SIDE_PANEL_HEADER_CLASS;\n\n    // Close button\n    const closeBtn = document.createElement(\"button\");\n    closeBtn.className = \"clickup-side-panel-close\";\n    closeBtn.innerHTML = \"âœ•\";\n    closeBtn.title = \"ë‹«ê¸°\";\n    closeBtn.onclick = () => this.hide();\n\n    // Title\n    const title = document.createElement(\"span\");\n    title.className = \"clickup-side-panel-title\";\n    title.textContent = \"ClickUp\";\n\n    // Open in new tab button\n    const newTabBtn = document.createElement(\"button\");\n    newTabBtn.className = \"clickup-side-panel-btn\";\n    newTabBtn.innerHTML = \"ðŸ”—\";\n    newTabBtn.title = \"ìƒˆ íƒ­ì—ì„œ ì—´ê¸°\";\n    newTabBtn.onclick = () => {\n      if (this.currentTaskId) {\n        window.open(this.getIframeSrc(this.currentTaskId), \"_blank\");\n      }\n    };\n\n    header.appendChild(closeBtn);\n    header.appendChild(title);\n    header.appendChild(newTabBtn);\n\n    // Create loading indicator\n    const loading = document.createElement(\"div\");\n    loading.className = SIDE_PANEL_LOADING_CLASS;\n    loading.textContent = \"ë¡œë”© ì¤‘...\";\n\n    // Create iframe\n    const iframe = document.createElement(\"iframe\");\n    iframe.className = SIDE_PANEL_IFRAME_CLASS;\n    iframe.setAttribute(\"allow\", \"clipboard-read; clipboard-write\");\n    iframe.style.display = \"none\";\n\n    // Assemble panel\n    this.panel.appendChild(header);\n    this.panel.appendChild(loading);\n    this.panel.appendChild(iframe);\n\n    document.body.appendChild(this.panel);\n  }\n\n  /**\n   * Adjust main content to make room for side panel\n   */\n  private adjustMainContent(showPanel: boolean): void {\n    const mainContent = document.querySelector<HTMLElement>(\n      \".content-wrapper, .layout-page, main\"\n    );\n    if (mainContent) {\n      if (showPanel) {\n        mainContent.style.marginRight = \"400px\";\n        mainContent.style.transition = \"margin-right 0.3s ease\";\n      } else {\n        mainContent.style.marginRight = \"\";\n      }\n    }\n  }\n}\n\n/**\n * Singleton instance for easy access\n */\nlet sidePanelInstance: SidePanel | null = null;\n\nexport function getSidePanel(): SidePanel {\n  if (!sidePanelInstance) {\n    sidePanelInstance = new SidePanel();\n  }\n  return sidePanelInstance;\n}\n\nexport function showSidePanel(taskId: string): void {\n  getSidePanel().show(taskId);\n}\n\nexport function hideSidePanel(): void {\n  getSidePanel().hide();\n}\n\nexport function pinToSidePanel(taskId: string): void {\n  getSidePanel().show(taskId);\n}\n\nexport function destroySidePanel(): void {\n  if (sidePanelInstance) {\n    sidePanelInstance.destroy();\n    sidePanelInstance = null;\n  }\n}\n","import { getClickUpPattern, getClickUpTaskUrl } from \"@domain/clickup\";\nimport { showModal, hideModal, pinToSidePanel, getModal } from \"./ui\";\n\nconst LINK_CLASS = \"clickup-link\";\nconst PROCESSED_ATTR = \"data-clickup-processed\";\n\n/**\n * Initialize modal with side panel callback\n */\nfunction initModal(): void {\n  getModal((taskId) => {\n    hideModal();\n    pinToSidePanel(taskId);\n  });\n}\n\n/**\n * Detect and transform ClickUp patterns in the document\n */\nexport function detectAndTransformClickUpPatterns(): void {\n  // Initialize modal with pin callback\n  initModal();\n\n  // Find all text nodes in MR notes\n  const noteContainers = document.querySelectorAll(\n    '.note-body, .md, [data-testid=\"note-body\"]'\n  );\n\n  noteContainers.forEach((container) => {\n    processContainer(container as HTMLElement);\n  });\n}\n\n/**\n * Process a container element for ClickUp patterns\n */\nfunction processContainer(container: HTMLElement): void {\n  // Skip if already processed\n  if (container.getAttribute(PROCESSED_ATTR) === \"true\") {\n    return;\n  }\n\n  const pattern = getClickUpPattern();\n  const walker = document.createTreeWalker(\n    container,\n    NodeFilter.SHOW_TEXT,\n    null\n  );\n\n  const nodesToProcess: { node: Text; matches: RegExpMatchArray[] }[] = [];\n\n  let node: Text | null;\n  while ((node = walker.nextNode() as Text)) {\n    // Skip nodes inside already created links\n    if (node.parentElement?.classList.contains(LINK_CLASS)) {\n      continue;\n    }\n\n    const text = node.textContent || \"\";\n    pattern.lastIndex = 0;\n\n    const matches: RegExpMatchArray[] = [];\n    let match: RegExpExecArray | null;\n\n    while ((match = pattern.exec(text)) !== null) {\n      matches.push([...match] as RegExpMatchArray);\n    }\n\n    if (matches.length > 0) {\n      nodesToProcess.push({ node, matches });\n    }\n  }\n\n  // Process nodes in reverse order to maintain correct positions\n  nodesToProcess.reverse().forEach(({ node, matches }) => {\n    transformTextNode(node, matches);\n  });\n\n  // Mark container as processed\n  container.setAttribute(PROCESSED_ATTR, \"true\");\n}\n\n/**\n * Transform a text node by replacing ClickUp patterns with clickable links\n */\nfunction transformTextNode(node: Text, matches: RegExpMatchArray[]): void {\n  const text = node.textContent || \"\";\n  const fragment = document.createDocumentFragment();\n\n  let lastIndex = 0;\n\n  matches.forEach((match) => {\n    const fullMatch = match[0];\n    const taskId = match[1];\n    const matchIndex = text.indexOf(fullMatch, lastIndex);\n\n    // Add text before match\n    if (matchIndex > lastIndex) {\n      fragment.appendChild(\n        document.createTextNode(text.slice(lastIndex, matchIndex))\n      );\n    }\n\n    // Create clickable link\n    const link = createClickUpLink(taskId);\n    fragment.appendChild(link);\n\n    lastIndex = matchIndex + fullMatch.length;\n  });\n\n  // Add remaining text after last match\n  if (lastIndex < text.length) {\n    fragment.appendChild(document.createTextNode(text.slice(lastIndex)));\n  }\n\n  // Replace original node\n  node.parentNode?.replaceChild(fragment, node);\n}\n\n/**\n * Create a clickable ClickUp link element\n */\nfunction createClickUpLink(taskId: string): HTMLAnchorElement {\n  const link = document.createElement(\"a\");\n  link.className = LINK_CLASS;\n  link.href = getClickUpTaskUrl(taskId);\n  link.textContent = `ðŸ”— CU-${taskId}`;\n  link.title = `ClickUp íƒœìŠ¤í¬: ${taskId}`;\n  link.setAttribute(\"data-task-id\", taskId);\n\n  // Prevent default navigation and show modal instead\n  link.onclick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    showModal(taskId);\n  };\n\n  // Allow Ctrl/Cmd+click to open in new tab\n  link.onmousedown = (e) => {\n    if (e.ctrlKey || e.metaKey) {\n      // Allow default behavior for new tab\n      link.target = \"_blank\";\n    }\n  };\n\n  return link;\n}\n\n/**\n * Reset processed state for all containers (useful for re-processing)\n */\nexport function resetProcessedState(): void {\n  const processedElements = document.querySelectorAll(\n    `[${PROCESSED_ATTR}=\"true\"]`\n  );\n  processedElements.forEach((el) => {\n    el.removeAttribute(PROCESSED_ATTR);\n  });\n}\n","import { createObserver, disconnectObserver } from \"@utils/observer\";\nimport { debounce } from \"@utils/debounce\";\nimport { detectAndTransformClickUpPatterns } from \"./detector\";\n\nconst OBSERVER_ID = \"clickup-content-observer\";\n\n/**\n * Creates a MutationObserver that watches for DOM changes\n * and detects ClickUp patterns in new content\n */\nexport function createClickUpContentObserver(): void {\n  const debouncedCallback = debounce(() => {\n    detectAndTransformClickUpPatterns();\n  }, 100);\n\n  createObserver({\n    id: OBSERVER_ID,\n    target: document.body,\n    callback: debouncedCallback,\n    config: { childList: true, subtree: true },\n  });\n}\n\n/**\n * Disconnects the ClickUp content observer\n */\nexport function disconnectClickUpContentObserver(): void {\n  disconnectObserver(OBSERVER_ID);\n}\n","/**\n * ClickUp Content Feature\n * Detects {{clickup:TASK_ID}} patterns and displays tasks in Modal/SidePanel\n */\n\nimport {\n  createClickUpContentObserver,\n  disconnectClickUpContentObserver,\n} from \"./observer\";\nimport { detectAndTransformClickUpPatterns, resetProcessedState } from \"./detector\";\nimport { destroyModal, destroySidePanel } from \"./ui\";\n\n/**\n * Initialize ClickUp content feature\n * - Sets up MutationObserver to watch for new content\n * - Performs initial scan of existing content\n */\nexport function initClickUpContent(): void {\n  // Initial detection\n  detectAndTransformClickUpPatterns();\n\n  // Start observing for new content\n  createClickUpContentObserver();\n}\n\n/**\n * Cleanup ClickUp content feature\n * - Disconnects observer\n * - Removes UI components\n */\nexport function cleanupClickUpContent(): void {\n  disconnectClickUpContentObserver();\n  resetProcessedState();\n  destroyModal();\n  destroySidePanel();\n}\n","/**\n * Content script entry point\n * Orchestrates feature initialization and cleanup\n */\n\nimport { initPnRule, cleanupPnRule } from \"@features/pn-rule\";\nimport { initRmMrFilter, cleanupRmMrFilter } from \"@features/rm-mr-filter\";\nimport { initClickUpContent, cleanupClickUpContent } from \"@features/clickup-content\";\n\n/**\n * Initialize all features\n */\nasync function init(): Promise<void> {\n  await initPnRule();\n  initRmMrFilter();\n  initClickUpContent();\n}\n\n/**\n * Cleanup all features\n */\nfunction cleanup(): void {\n  cleanupPnRule();\n  cleanupRmMrFilter();\n  cleanupClickUpContent();\n}\n\n// Initialize on load\ninit();\n\n// Cleanup on unload (for SPA navigation)\nwindow.addEventListener('beforeunload', cleanup);\n"],"mappings":"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","names":["OBSERVER_ID","node","OBSERVER_ID"]}